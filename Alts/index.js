(function(p,d,t,h,w,a,i){"use strict";var o=void 0;const{FormSection:v,FormRow:f,FormInput:S}=w.Forms,{View:E,Image:T,Alert:R,Text:P}=w.General,l=d.findByProps("getCurrentUser"),C=d.findByProps("getToken"),g=d.findByProps("login","logout");d.findByProps("sendMessage");function u(e){return e.avatar?`https://cdn.discordapp.com/avatars/${e.id}/${e.avatar}.png`:"https://cdn.discordapp.com/embed/avatars/0.png"}function b(e,r){try{g.login(e),i.showToast(`Switching to ${r}...`,u({}))}catch{g.logout(),setTimeout(function(){return g.login(e)},500)}}var A={onLoad:function(){t.storage.accounts||(t.storage.accounts=[]),o.unloadSave=h.registerCommand({name:"alt save",displayName:"alt save",description:"Save your current account to the switcher",displayDescription:"Save your current account to the switcher",execute:function(){const e=l.getCurrentUser(),r=C.getToken();if(t.storage.accounts.some(function(c){return c.id===e.id})){i.showToast("Account already saved!",u(e));return}t.storage.accounts.push({id:e.id,name:e.username,avatar:u(e),token:r}),i.showToast(`Saved ${e.username}!`,u(e))},options:[],applicationId:"-1",inputType:1,type:1}),o.unloadList=h.registerCommand({name:"alt list",displayName:"alt list",description:"List all saved accounts in chat",displayDescription:"List all saved accounts in chat",execute:function(e,r){if(t.storage.accounts.length===0){i.showToast("No accounts saved.");return}t.storage.accounts.map(function(c,s){return`${s+1}. **${c.name}**`}).join(`
`),i.showToast(`Found ${t.storage.accounts.length} accounts.`)},options:[],applicationId:"-1",inputType:1,type:1}),o.unloadSwitch=h.registerCommand({name:"alt switch",displayName:"alt switch",description:"Switch to a specific account",displayDescription:"Switch to a specific account",execute:function(e){const r=e.find(function(s){return s.name==="name"})?.value?.toLowerCase(),c=t.storage.accounts.find(function(s){return s.name.toLowerCase().includes(r)});c?b(c.token,c.name):i.showToast("Account not found.")},options:[{name:"name",description:"The username to switch to",type:3,required:!0}],applicationId:"-1",inputType:1,type:1})},onUnload:function(){o.unloadSave&&o.unloadSave(),o.unloadList&&o.unloadList(),o.unloadSwitch&&o.unloadSwitch()},settings:function(){const[e,r]=a.React.useState(""),[c,s]=a.React.useState(""),[$,m]=a.React.useReducer(function(n){return n+1},0),L=function(){const n=l.getCurrentUser(),y=C.getToken();if(t.storage.accounts.some(function(k){return k.id===n.id}))return R.alert("Error","Account already saved.");t.storage.accounts.push({id:n.id,name:n.username,avatar:u(n),token:y}),m()};return a.React.createElement(E,{style:{flex:1}},a.React.createElement(v,{title:"Quick Actions"},a.React.createElement(f,{label:"Save Current Account",subLabel:`Log in as ${l.getCurrentUser()?.username}`,leading:a.React.createElement(T,{source:{uri:u(l.getCurrentUser())},style:{width:32,height:32,borderRadius:16}}),onPress:L})),a.React.createElement(v,{title:`Saved Accounts (${t.storage.accounts.length})`},t.storage.accounts.map(function(n,y){return a.React.createElement(f,{label:n.name,subLabel:"Tap to switch",leading:a.React.createElement(T,{source:{uri:n.avatar},style:{width:32,height:32,borderRadius:16}}),onPress:function(){R.alert("Switch Account",`Log in as ${n.name}?`,[{text:"Cancel",style:"cancel"},{text:"Switch",onPress:function(){return b(n.token,n.name)}},{text:"Delete",style:"destructive",onPress:function(){t.storage.accounts.splice(y,1),m()}}])}})})),a.React.createElement(v,{title:"Manual Add"},a.React.createElement(S,{value:e,onChange:r,placeholder:"Name"}),a.React.createElement(S,{value:c,onChange:s,placeholder:"Token",secureTextEntry:!0}),a.React.createElement(f,{label:"Add Account",disabled:!e||!c,onPress:function(){t.storage.accounts.push({id:Date.now().toString(),name:e,avatar:"https://cdn.discordapp.com/embed/avatars/0.png",token:c}),r(""),s(""),m()}})))}};return p.default=A,Object.defineProperty(p,"__esModule",{value:!0}),p})({},vendetta.metro,vendetta.plugin,vendetta.commands,vendetta.ui.components,vendetta.metro.common,vendetta.ui.toasts);
