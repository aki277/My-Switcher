(function(o,l,a,f,t){"use strict";const{FormSection:i,FormRow:c,FormInput:v}=f.Forms,{View:b,Image:h,Alert:r}=f.General,R=l.findByProps("getCurrentUser"),k=l.findByProps("getToken"),d=l.findByProps("login","logout");function y(n){return n.avatar?`https://cdn.discordapp.com/avatars/${n.id}/${n.avatar}.png`:"https://cdn.discordapp.com/embed/avatars/0.png"}var A={onLoad:function(){a.storage.accounts||(a.storage.accounts=[])},settings:function(){const[n,p]=t.React.useState(""),[s,E]=t.React.useState(""),[T,g]=t.React.useReducer(function(e){return e+1},0),m=function(){const e=R.getCurrentUser(),u=k.getToken();if(!e||!u)return r.alert("Error","Could not fetch current user info.");if(a.storage.accounts.some(function(w){return w.id===e.id}))return r.alert("Error","This account is already saved!");a.storage.accounts.push({id:e.id,name:e.username,avatar:y(e),token:u}),r.alert("Success",`Saved account: ${e.username}`),g()},P=function(){!n||!s||(a.storage.accounts.push({id:"manual-"+Date.now(),name:n,avatar:"https://cdn.discordapp.com/embed/avatars/0.png",token:s}),p(""),E(""),g())},C=function(e){r.alert("Switch Account",`Log in as ${e.name}?`,[{text:"Cancel",style:"cancel"},{text:"Login",onPress:function(){try{d.login(e.token)}catch{d.logout(),setTimeout(function(){return d.login(e.token)},500)}}}])},S=function(e){a.storage.accounts.splice(e,1),g()};return t.React.createElement(b,{style:{flex:1}},t.React.createElement(i,{title:"Quick Actions"},t.React.createElement(c,{label:"Save Current Account",subLabel:"Instantly save the user you are currently logged in as",leading:t.React.createElement(h,{source:{uri:y(R.getCurrentUser())},style:{width:32,height:32,borderRadius:16}}),onPress:m})),t.React.createElement(i,{title:"Saved Accounts"},a.storage.accounts.length===0&&t.React.createElement(c,{label:"No accounts saved yet"}),a.storage.accounts.map(function(e,u){return t.React.createElement(c,{label:e.name,subLabel:e.token?"Ready to switch":"Invalid Token",leading:t.React.createElement(h,{source:{uri:e.avatar},style:{width:32,height:32,borderRadius:16}}),onPress:function(){return C(e)},onLongPress:function(){r.alert("Delete Account",`Remove ${e.name}?`,[{text:"Cancel"},{text:"Delete",style:"destructive",onPress:function(){return S(u)}}])}})})),t.React.createElement(i,{title:"Add Account Manually"},t.React.createElement(v,{value:n,onChange:p,placeholder:"Account Name"}),t.React.createElement(v,{value:s,onChange:E,placeholder:"Token (OTk...)",secureTextEntry:!0}),t.React.createElement(c,{label:"Add Account",onPress:P,disabled:!n||!s})))}};return o.default=A,Object.defineProperty(o,"__esModule",{value:!0}),o})({},vendetta.metro,vendetta.plugin,vendetta.ui.components,vendetta.metro.common);
